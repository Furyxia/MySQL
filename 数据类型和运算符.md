# 数据类型和运算符

## 1.MySQL数据类型介绍

MySQL支持多种数据类型，主要有数值类型，日期/时间类型和字符串类型：
1. 数值数据类型：包括整数类型TINYINT,SMALLINT,MEDIUMINT,INT,BIGINT,浮点小数数据类型FLOAT和DOUBLE，定点小数类型DECIMAL；
2. 日期/时间类型：包括YEAR,TIME,DATE,DATETIME和TIMESTAMP；
3. 字符串类型：包括CHAR,VARCHAR,BINARY,VARBINARY,BLOB,TEXT,ENUM和SET等。字符串类型分为文本字符串和二进制字符串。

### 1.1 整数类型

数值型数据类型主要用来存储数字，MySQL提供了多种数据类型，不同的数据类型提供不同的取值范围，可以存储的值范围越大，其所需的存储空间就会越大。

MySQL主要提供的整数类型有：TINYINT，SMALLINT,MEDIUMINT,INT(INTEGER),BIGINT。整数类型的属性字段可以添加AUTO_INCREMENT自增约束条件。如表所示：

**MySQL中的整数型数据类型**

|类型名称|说明|存储需求|
|:---|:---|:---|
|TINYINT|很小的整数|1个字节|
|SMALLINT|小的整数|2个字节|
|MEDIUMINT|中等大小的整数|3个字节|
|INT(INTEGER)&#160;&#160;&#160;&#160;&#160;&#160;|普通大小的整数&#160;&#160;&#160;&#160;&#160;&#160;|4个字节&#160;&#160;&#160;&#160;&#160;&#160;|
|BIGINT|大整数|8个字节|

**不同整数类型的取值范围**

|数据类型|有符号|无符号|
|:---|:---|:---|
|TINYINT|-128~127|0~255|
|SMALLINT|-32768~32767|0~65535|
|MEDIUMINT|-8388608~8388607|0~16777215|
|INT(INTEGER)&#160;&#160;&#160;&#160;&#160;&#160;|-2147483648~2147483647|0~4294967295|
|BIGINT|-9223372036854775808~9223372036854775807&#160;&#160;&#160;&#160;|0~18446744073709551615&#160;&#160;&#160;&#160;|

在“数据表的基本操作”章节中，有如下创建表的语句：

```
mysql> create table tb_emp1
    -> (
    -> id INT(11),
    -> name VARCHAR(25),
    -> deptId INT(11),
    -> salary FLOAT
    -> );
```

id字段的数据类型为INT(11)，INT括号中的数字表示的是该数据类型指定的显示宽度，指能够显示的数值中数字的个数。

例如：声明一个INT类型的字段：

```
year INT(4)
```

该声明指，在year字段中的数据一般只显示4位数字的宽度。

**注意：** 显示宽度和数据类型的取值范围是无关的。显示宽度只是指明MySQL最大可能显示的数字个数，数值的位数小于指定的宽度时会由空格填充；如果插入了大于显示宽度的值，只该值不超过该类型整数的取值范围，数值依然可以插入，而且能够显示出来。

**示例：** 创建表tmp1，其字段x，y，z，m，n数据类型依次为TINYINT，SMALLINT，MEDIUMINT，INT，BIGINT：

```
mysql> CREATE TABLE tmp1 (x TINYINT, y SMALLINT, z MEDIUMINT, m INT, n BIGINT);
mysql> DESC tmp1;
+-------+--------------+------+-----+---------+-------+
| Field | Type         | Null | Key | Default | Extra |
+-------+--------------+------+-----+---------+-------+
| x     | tinyint(4)   | YES  |     | NULL    |       |
| y     | smallint(6)  | YES  |     | NULL    |       |
| z     | mediumint(9) | YES  |     | NULL    |       |
| m     | int(11)      | YES  |     | NULL    |       |
| n     | bigint(20)   | YES  |     | NULL    |       |
+-------+--------------+------+-----+---------+-------+
5 rows in set (0.00 sec)
```

若没有无标明类型的显示宽度，系统将添加不同的默认宽度。这些默认宽度可以保证显示每一种数据类型可以取到范围内的所有值。

<br>

### 1.2 浮点数类型和定点数类型

MySQL中使用浮点数和定点数来表示小数。

浮点类型有两种：单精度浮点类型(FLOAT)和双精度浮点类型(DOUBLE)。

定点类型只有一种：DECIMAL。

浮点类型和定点类型都可以用(M,N)来表示，其中M称为精度，表示总共的位数；N称为标度，是表示小数的位数。

**MySQL中的小数类型**

|类型名称|说明|存储需求|
|:---|:---|:---|
|FLOAT|单精度浮点数|4个字节|
|DOUBLE|双精度浮点数|8个字节|
|DECIMAL(M,D),DEC&#160;&#160;&#160;&#160;|压缩的“严格”定点数&#160;&#160;&#160;&#160;|M+2个字节&#160;&#160;&#160;&#160;|

DECIMAL类型不同于FLOAT和DOUBLE，DECIMAL实际是以串存放的，DECIMAL可能的最大取值范围与DOUBLE一样，但其有效的取值范围由M和D的值决定。

**示例：** 创建表tmp2，其中字段x，y，z数据类型依次为FLOAT(5,1)，DOUBLE(5,1)和DECIMAL(5,1)，并向表中插入数据5.12，5.15和5.123：

```
mysql> CREATE TABLE tmp2 (x FLOAT(5,1), y DOUBLE(5,1), z DECIMAL(5,1));
Query OK, 0 rows affected, 2 warnings (0.14 sec)
mysql> INSERT INTO tmp2 VALUES(5.12, 5.15, 5.123);
Query OK, 1 row affected, 1 warning (0.06 sec)
```

插入数据时，MySQL会抛出一个警告信息，使用SHOW WARNINGS可以查看警告信息：

```
mysql> SHOW WARNINGS;
+-------+------+----------------------------------------+
| Level | Code | Message                                |
+-------+------+----------------------------------------+
| Note  | 1265 | Data truncated for column 'z' at row 1 |
+-------+------+----------------------------------------+
1 row in set (0.00 sec)
```

可以看到FLOAT和DOUBLE在进行四舍五入时并没有发出警告，但给出z字段数值被阶段的警告。查看结果：

```
mysql> SELECT * FROM tmp2;
+------+------+------+
| x    | y    | z    |
+------+------+------+
|  5.1 |  5.2 |  5.1 |
+------+------+------+
1 row in set (0.00 sec)
```
FLOAT和DOUBLE在不指定精度时，默认会按照实际的精度，DECIMAL若不指定精度，默认是(10,0)。

**浮点数相对与定点数的优点在于在长度一定的情况下，浮点数能够表示更大的数据范围；但缺点是会引发精度问题**

#### 提示

在MySQL中，定点数以字符串形式存储，在对精度要求比较高的时候（如货币，科学数据等）使用DECIMAL的类型比较好，另外两个浮点数进行减法和比较运算时也容易出问题，所以在使用浮点型时需要注意，并尽量避免做浮点比较。

<br>

### 1.3 日期与时间类型

MySQL中有多种表示日期的数据类型，主要有：DATETIME，DATE，TIMESTAMP，TIME和YEAR。每一个类型都会有合法的取值范围，当指定确实不合法的值时系统将“零”值插入到数据库中。

**日期与实践数据类型**

|类型名称|日期格式|日期范围|存储需求|
|:---|:---|:---|:---|
|YEAR|YYYY|1901~2155|1字节|
|TIME|HH：MM：SS|-835：59：59~838：59：59|3字节|
|DATE|YYYY-MM-DD|1000-01-01~9999-12-31|3字节|
|DATETIME|YYYY-MM-DD HH：MM：SS|1000-01-01 00：00：00~9999-12-31 23：59：59|8字节|
|TIMESTAMP&#160;&#160;|YYYY-MM-DD HH：MM：SS&#160;&#160;|1970-01-01 00：00：01 UTC~2038-01-19 03：14：07 UTC&#160;&#160;|4字节&#160;&#160;&#160;&#160;|

<br>

**1. YEAR**

YEAR类型是一个单字节类型用来表示年，在存储时只需要1个字节。可以使用各种形式指定YEAR值，如下：

1. 以4位字符串或者4位数字格式表示的YEAR，范围为‘1901’~‘2155’。输入格式为‘YYYY’或YYYY。
2. 以2位字符串格式表示YEAR，范围为‘00’到‘99’。‘00’~‘69’和‘70’~‘99’范围的值分别被转换为2000~2069和1970~1999范围的YEAR值。
3. 以2位数字表示YEAR，范围位1~99.1~69和70~99范围的值分别被转换位2001~2069和1970~1999范围的YEAR值。注意：这里的0值将被转换位0000，而不是2000。

**示例1：** 创建数据表tmp3，定义数据类型位YEAR的字段y，向表中插入值2010，‘2010’，‘2166’

```
mysql> CREATE TABLE tmp3(y YEAR);
Query OK, 0 rows affected (0.13 sec)

mysql> INSERT INTO tmp3 VALUES(2010), ('2010');
Query OK, 2 rows affected (0.05 sec)
Records: 2  Duplicates: 0  Warnings: 0

mysql> INSERT INTO tmp3 VALUES('2166');
ERROR 1264 (22003): Out of range value for column 'y' at row 1
mysql> SHOW WARNINGS;
+-------+------+--------------------------------------------+
| Level | Code | Message                                    |
+-------+------+--------------------------------------------+
| Error | 1264 | Out of range value for column 'y' at row 1 |
+-------+------+--------------------------------------------+
1 row in set (0.00 sec)
```

可以看到，插入第3个值2166超过了YEAR类型的取值范围，因此不能正常的执行插入操作。

```
mysql> SELECT * FROM tmp3;
+------+
| y    |
+------+
| 2010 |
| 2010 |
+------+
```

**示例2：** 向tmp3表中y字段插入2个字符串表示的YEAR值，分别位‘0’，‘00’，‘77’和‘10’

```
mysql> DELETE FROM tmp3;
Query OK, 2 rows affected (0.05 sec)

mysql> INSERT INTO tmp3 VALUES('0'),('00'),('77'),('10');
Query OK, 4 rows affected (0.05 sec)
Records: 4  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM tmp3;
+------+
| y    |
+------+
| 2000 |
| 2000 |
| 1977 |
| 2010 |
+------+
```

**示例3：** 向tmp3表中y字段插入2位数字表示的YEAR值，分别位0，78和11

```
mysql> DELETE FROM tmp3;
Query OK, 4 rows affected (0.05 sec)

mysql> INSERT INTO tmp3 VALUES (0),(78),(11);
Query OK, 3 rows affected (0.05 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM tmp3;
+------+
| y    |
+------+
| 0000 |
| 1978 |
| 2011 |
+------+
```

<br>

**2. TIME**

TIME类型用于只需要时间信息的值，在存储时需要3个字节。格式位'HH：MM：SS'。HH表示小时；MM表示分钟；SS表示秒。小时部分之所以那么大，是因为TIME类型不仅可以用于表示一天的时间（必须小于24小时），还可能是某个事件过去的时间或两个时间之间的时间间隔。

可以使用各种格式指定TIME值：
1. ‘D HH：MM：SS’格式的字符串。还可以使用下面任何一种“非严格”的语法：‘HH：MM：SS’，‘HH：MM’，‘D HH：MM’，‘D HH'或’SS'。这里的D表示日，可以取0~34之间的值。在插入数据库时，D被转换为小时保存，格式为“D*24+HH”。
2. ‘HHMMSS’格式的，没有间隔符的字符串或者HHMMSS格式的值，假定是有意义的时间。

#### 提示

为TIME列分配简写值时应注意：如果没有冒号，MySQL解释值时，假定最后边的两位表示秒！

**示例1：** 创建数据表tmp4，定义数据类型为TIME的字段，向表中插入‘10：05：05’，‘23：23’，‘2 10：10’，‘3 02’，‘10’

```
mysql> CREATE TABLE tmp4(t TIME);
Query OK, 0 rows affected (0.13 sec)

mysql> INSERT INTO tmp4 VALUES('10:05:05'),('23:23'),('2 10:10'),('3 02'),('10');
Query OK, 5 rows affected (0.01 sec)
Records: 5  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM tmp4;
+----------+
| t        |
+----------+
| 10:05:05 |
| 23:23:00 |
| 58:10:00 |
| 74:00:00 |
| 00:00:10 |
+----------+
```

**示例2：** 向表tmp4中插入值‘101112’，111213，‘0’，107010

```
mysql> DELETE FROM tmp4;
Query OK, 5 rows affected (0.00 sec)

mysql> INSERT INTO tmp4 VALUES('101112'),(111213),('0');
Query OK, 3 rows affected (0.01 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql> INSERT INTO tmp4 VALUES(107010);
ERROR 1292 (22007): Incorrect time value: '107010' for column 't' at row 1
mysql> SHOW WARNINGS;
+-------+------+--------------------------------------------------------+
| Level | Code | Message                                                |
+-------+------+--------------------------------------------------------+
| Error | 1292 | Incorrect time value: '107010' for column 't' at row 1 |
+-------+------+--------------------------------------------------------+
1 row in set (0.00 sec)

mysql> SELECT * FROM tmp4;
+----------+
| t        |
+----------+
| 10:11:12 |
| 11:12:13 |
| 00:00:00 |
+----------+
```

**示例3：** 向tmp4表中插入系统当前时间

```
mysql> DELETE FROM tmp4;
Query OK, 3 rows affected (0.05 sec)

mysql> INSERT INTO tmp4 VALUES (CURRENT_TIME),(NOW());
Query OK, 2 rows affected (0.01 sec)
Records: 2  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM tmp4;
+----------+
| t        |
+----------+
| 14:11:37 |
| 14:11:37 |
+----------+
```

<br>

**3. DATE类型**

DATE类型用在仅需要日期值时，没有时间部分，在存储时需要3个字节。日期格式为‘YYYY-MM-DD’，其中YYYY表示年；MM表示月；DD表示日。

在给DATE类型的字段赋值时，可以使用字符串类型或者数字类型的数据插入，只要DATE的日期格式即可：
1. 以‘YYYY-MM-DD’或者‘YYYYMMDD’字符串格式表示的日期，取值范围为‘1000-01-01’~‘9999-12-31’。
2. 以‘YY-MM-DD’或者‘YYMMDD’字符串格式表示的日期，在这里YY表示两位的年值。
3. 以YY-MM-DD或者YYMMDD数字格式表示的日期。
4. 使用CURRENT_DATE或者NOW()，插入当前系统日期。

**示例1：** 创建数据表tmp5，定义数据类型为DATE的字段d，向表中插入“YYYY-MM-DD”和“YYYYMMDD”字符串格式日期

```
mysql> CREATE TABLE tmp5 (d DATE);
Query OK, 0 rows affected (0.04 sec)

mysql> INSERT INTO tmp5 VALUES ('1998-08-08'),('19980808'),('20101010');
Query OK, 3 rows affected (0.01 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM tmp5;
+------------+
| d          |
+------------+
| 1998-08-08 |
| 1998-08-08 |
| 2010-10-10 |
+------------+
```

**示例2：** 向tmp5表中插入“YY-MM-DD"和“YYMMDD”字符串格式的日期

```
mysql> DELETE FROM tmp5;
Query OK, 3 rows affected (0.01 sec)

mysql> INSERT INTO tmp5 VALUES ('99-09-09'),('990909'),('000101'),('111111');
Query OK, 4 rows affected (0.00 sec)
Records: 4  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM tmp5;
+------------+
| d          |
+------------+
| 1999-09-09 |
| 1999-09-09 |
| 2000-01-01 |
| 2011-11-11 |
+------------+
```

**示例3：** 向tmp5表中插入YY-MM-DD和YYMMDD数字格式日期

```
mysql> DELETE FROM tmp5;
Query OK, 3 rows affected (0.01 sec)

mysql> INSERT INTO tmp5 VALUES (990909),( 000101),( 111111);
Query OK, 3 rows affected (0.01 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM tmp5;
+------------+
| d          |
+------------+
| 1999-09-09 |
| 2000-01-01 |
| 2011-11-11 |
+------------+
```

**示例4：** 向tmp5表中插入系统当前日期

```
mysql> DELETE FROM tmp5;
Query OK, 3 rows affected (0.01 sec)

mysql> INSERT INTO tmp5 VALUES (CURRENT_DATE()),(NOW());
Query OK, 2 rows affected, 1 warning (0.01 sec)
Records: 2  Duplicates: 0  Warnings: 1

mysql> SELECT * FROM tmp5;
+------------+
| d          |
+------------+
| 2019-11-18 |
| 2019-11-18 |
+------------+
```

CURRENT_DATE只返回当前日期，不包括时间部分；NOW()函数返回日期和时间值，在保存到数据库时，只保留了其日期部分。

**4. DATETIME**

DATETIME类型用在需要同时包含日期和时间信息的值，在存储时需要8个字节。日期格式为‘YYYY-MM-DD HH：MM：SS’。

其中：

* YYYY表示年；
* MM表示月；
* DD表示日；
* HH表示小时；
* MM表示分钟；
* SS表示秒；

在给DATETIME类型的字段赋值时，可以使用字符串类型或数字类型的数据插入，只要符合DATETIME的日期格式即可，如：
1. 以‘YYYY-MM-DD HH：MM：SS’或者‘YYYYMMDDHHMMSS’字符串格式表示的值，取值范围为‘1000-01-01 00：00：00’~‘9999-12-31 23：59：59’。
2. 以‘YY-MM-DD HH：MM：SS’或者‘YYMMDDHHMMSS’字符串格式表示的日期，这里YY表示两位的年值。
3. 以YYYYMMDDHHMMSS或者YYMMDDHHMMSS数字格式表示的日期和时间。

**示例1：** 创建数据表tmp6，定义数据类型为DATETIME的字段dt，向表中插入“YYYY-MM-DD HH：MM：SS”和“YYYYMMDDHHMMSS”字符串格式的日期和时间值

```
mysql> CREATE TABLE tmp6 (dt DATETIME);
Query OK, 0 rows affected (0.14 sec)

mysql> INSERT INTO tmp6 VALUES ('1998-08-08 08:08:08'),('19980808080808'),('20101010101010');
Query OK, 3 rows affected (0.06 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM tmp6;
+---------------------+
| dt                  |
+---------------------+
| 1998-08-08 08:08:08 |
| 1998-08-08 08:08:08 |
| 2010-10-10 10:10:10 |
+---------------------+
```

**示例2：** 向tmp6表中插入“YY-MM-DD HH：MM：SS”和“YYMMDDHHMMSS”字符串格式日期值和时间值

```
mysql> DELETE FROM tmp6;
Query OK, 3 rows affected (0.05 sec)

mysql> INSERT INTO tmp6 VALUES ('99-09-09 09:09:09'),('990909090909'),('101010101010');
Query OK, 3 rows affected (0.05 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM tmp6;
+---------------------+
| dt                  |
+---------------------+
| 1999-09-09 09:09:09 |
| 1999-09-09 09:09:09 |
| 2010-10-10 10:10:10 |
+---------------------+
```

**示例3：** 向tmp6表中插入YYYYMMDDHHMMSS和YYMMDDHHMMSS数字格式日期和时间值

```
mysql> DELETE FROM tmp6;
Query OK, 3 rows affected (0.05 sec)

mysql> INSERT INTO tmp6 VALUES (19990909090909),(101010101010);
Query OK, 2 rows affected (0.05 sec)
Records: 2  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM tmp6;
+---------------------+
| dt                  |
+---------------------+
| 1999-09-09 09:09:09 |
| 2010-10-10 10:10:10 |
+---------------------+
```

**示例4：** 向tmp6表中插入系统当前日期和时间值

```
mysql> DELETE FROM tmp6;
Query OK, 2 rows affected (0.05 sec)

mysql> INSERT INTO tmp6 VALUES (NOW());
Query OK, 1 row affected (0.05 sec)

mysql> SELECT * FROM tmp6;
+---------------------+
| dt                  |
+---------------------+
| 2019-11-18 21:58:51 |
+---------------------+
```

NOW()函数返回当前系统的日期和时间，格式为“YYYY-MM-DD HH：MM：SS”

**5. TIMESTAMP**

TIMESTAMP是显示格式与DATETIME相同，显示宽度固定在19个字符，日期格式为YYYY-MM-DD HH：MM：SS，在存储时需要4个字节。

但是TIMESTAMP列的取值范围小于DATETIME的取值范围，为‘1970-01-01 00：00：01’ UTC ~ ‘2038-01-19 03：14：07’ UTC，其中UTC为时间标准时间

**示例1：** 创建数据表tmp7，定义数据类型为TIMESTAMP的字段ts，向表中插入值‘19950101010101’，‘950505050505’，‘1996-02-02 02：02：02’，‘97@03@03@03@03@03’，121212121212，NOW()

```
mysql> CREATE TABLE tmp7 (ts TIMESTAMP);
Query OK, 0 rows affected (0.14 sec)

mysql> INSERT INTO tmp7 VALUES ('19950101010101'),('950505050505'),('1996-02-02 02:02:02'),('97@03@03@03@03@03'),(121212121212),(NOW());
Query OK, 6 rows affected (0.07 sec)
Records: 6  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM tmp7;
+---------------------+
| ts                  |
+---------------------+
| 1995-01-01 01:01:01 |
| 1995-05-05 05:05:05 |
| 1996-02-02 02:02:02 |
| 1997-03-03 03:03:03 |
| 2012-12-12 12:12:12 |
| 2019-11-18 23:05:52 |
+---------------------+
```

#### 提示

TIMESTAMP与DATETIME除了在存储字节和支持的范围不同外，还有一个最大的区别就是：

* DATETIME在存储日期数据时，按实际输入的格式存储，与时间无关；
* TIMESTAMP值的存储是以UTC(世界标准时间)格式保存的，存储时对当前时区进行转换，检索时再转换回当前时区。

**示例2：** 向tmp7表中插入当前日期，查看插入值，更改时区为东10区

```
mysql> DELETE FROM tmp7;
Query OK, 6 rows affected (0.05 sec)

mysql> INSERT INTO tmp7 VALUES (NOW());
Query OK, 1 row affected (0.05 sec)

mysql> SELECT * FROM tmp7;
+---------------------+
| ts                  |
+---------------------+
| 2019-11-18 23:08:19 |
+---------------------+

mysql> SET TIME_ZONE='+10:00';
Query OK, 0 rows affected (0.06 sec)

mysql> SELECT * FROM tmp7;
+---------------------+
| ts                  |
+---------------------+
| 2019-11-19 01:08:19 |
+---------------------+
```

可以看到，因为东十区时间比东八区快2个小时，因此查询的结果经过时区转换之后，显示的值增加了2个小时。

<br>

### 1.4 文本字符串类型

字符串类型用来存储字符串数据，除了可以存储字符串数据之外，还可以存储其他数据。MySQL支持两类字符型数据：文本字符串和二进制字符串。

MySQL中文本字符串类型指CHAR，VARCHAR，TEXT，ENUM和SET。

**MySQL中文本字符串数据类型**

|类型名称|说明|存储需求|
|:---|:---|:---|
|CHAR(M)|固定长度非二进制字符串|M字节，1<=M<=255|
|VARCHAR(M)&#160;&#160;&#160;&#160;|变长非二进制字符串|L+1字节，L<=M和1<=M<=255|
|TINYTEXT|非常小的非二进制字符串|L+1字节，L<2^8|
|TEXT|小的非二进制字符串|L+2字节，L<2^16|
|MEDIUMTEXT|中等大小的非二进制字符串|L+3字节，L<2^24|
|LONGTEXT|大的非二进制字符串|L+4字节，L<2^32|
|ENUM|枚举类型，只能由一个枚举字符串值|1或2个字节，取决于枚举值的数目(最大65635)|
|SET|一个设置，字符串对象可以由零个或多个SET成员&#160;&#160;&#160;&#160;|1，2，3，4或8个字节，取决于集合成员的数量(最多64个成员)&#160;&#160;&#160;&#160;|

<br>

**1. CHAR和VARCHAR类型**

CHAR(M)为固定长度字符串，在定义时指定字符串列长。当保存时在右侧填充空格以达到指定的长度。M表示列长度，M的范围是0~255个字符。当检索到CHAR值时，尾部的空格将被删除。

VARCHAR(M)是长度可变的字符串，M表示最大列长度，M的范围是0~65535。VARCHAR的最大实际长度由最长的行的大小和使用的字符集确定，而实际占用的空间为字符串的实际长度加1。

**示例1：** 将不同的字符串保存到CAHR(4)和VARCHAR(4)列，说明CHAR(4)和VARCHAR(4)之间的差别

**CHAR(4)与VARCHAR(4)存储区别**

|插入值|CHAR(4)|存储需求|VARCHAR(4)|存储需求|
|:---|:---|:---|:---|:---|
|''|'&#160;&#160;&#160;&#160;'|4个字节|''|1个字节|
|'ab'|'ab&#160;&#160;'|4个字节|'ab'|3个字节|
|'abc'|'abc '|4个字节|'abc'|4个字节|
|'abcd'|'abcd'|4个字节|'abcd'|5个字节|
|'abcdef'&#160;&#160;|'abcd'|4个字节&#160;&#160;|'abcd'|5个字节&#160;&#160;|

**示例2：** 创建tmp8表，定义字段ch和vch数据类型依次为CHAR(4)和VARCHAR(4)，向表中插入数据'ab&#160;&#160;'

```
mysql> CREATE TABLE tmp8 (ch CHAR(4), vch VARCHAR(4));
Query OK, 0 rows affected (0.13 sec)

mysql> INSERT INTO tmp8 VALUES('ab  ','ab  ');
Query OK, 1 row affected (0.06 sec)

mysql> SELECT concat('(',ch,')'), concat('(',vch,')') FROM tmp8;
+--------------------+---------------------+
| concat('(',ch,')') | concat('(',vch,')') |
+--------------------+---------------------+
| (ab)               | (ab  )              |
+--------------------+---------------------+
```

从查询结果中可以看到，ch保存'ab&#160;&#160;'时将末尾的两个空格删除了，而vch字段保留了末尾的两个空格。

<br>

**2. TEXT类型**

TEXT列保存非二进制字符串。当保存或查询TEXT列的值时，不删除尾部空格。TEXT类型分为4种：TINYTEXT，TEXT，MEDIUMTEXT和LONGTEXT。不同类型的TEXT类型的存储空间和数据长度不同。

<br>

**3. ENUM类型**

ENUM是一个字符串对象，其值为表创建时在列规定中枚举的一列值。

语法格式为：

`字段名 ENUM('值1','值2',...,'值n')`

字段名指将要定义的字段，值n指枚举列表中的第n个值。ENUM类型的字段在取值时，只能在指定的枚举列表中取，而且一次只能取一个。若创建枚举值均有一个索引值：列表值所允许的成员从1开始编号，MySQL存储的就是这个索引编号。枚举最多可以有65535个元素。

例如定义ENUM类型的列('first','second','third')，该列可以取的值和每个值的索引如下所示：

|值|索引|
|:---|:---|
|NULL|NULL&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;|
|"|0|
|first|1|
|second&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;|2|
|third|3|

ENUM值依照列索引顺序排序，并且空字符串排在非空字符串前，NULL值排在其他所有枚举值之前。

**示例1：** 创建tmp9，并向其中插入值

```
mysql> CREATE TABLE tmp9 (enum ENUM('first','second','third'));
Query OK, 0 rows affected (0.09 sec)

mysql> INSERT INTO tmp9 VALUES ('first'),('second'),('third'),(NULL);
Query OK, 4 rows affected (0.05 sec)
Records: 4  Duplicates: 0  Warnings: 0

mysql> SELECT enum, enum+0 FROM tmp9;
+--------+--------+
| enum   | enum+0 |
+--------+--------+
| first  |      1 |
| second |      2 |
| third  |      3 |
| NULL   |   NULL |
+--------+--------+
```

ENUM列总有一个默认值。如果将ENUM列声明为NULL，NULL值则为该列的一个有效值，并且默认值为NULL。如果ENUM列被声明为NOT NULL，其默认值为允许的值列表的第一个元素。

**示例2：** 创建表tmp10，定义INT类型的soc字段，ENUM类型的字段level，列表值为('excellent','good','bad')，向表tmp10中插入'good'，1，2，3，'best'

```
mysql> CREATE TABLE tmp10 (soc INT, level enum('excellent','good','bad'));
Query OK, 0 rows affected (0.05 sec)

mysql> INSERT INTO tmp10 VALUES (70, 'good'),(90,1),(75,2),(50,3);
Query OK, 4 rows affected (0.01 sec)
Records: 4  Duplicates: 0  Warnings: 0

mysql> INSERT INTO tmp10 VALUES (100,'best');
ERROR 1265 (01000): Data truncated for column 'level' at row 1
```

**因为字符串'best'不在ENUM列表中，所以数据进行了阻止插入操作**

查询结果：

```
mysql> SELECT * FROM tmp10;
+------+-----------+
| soc  | level     |
+------+-----------+
|   70 | good      |
|   90 | excellent |
|   75 | good      |
|   50 | bad       |
+------+-----------+
```

由于结果可以看到，因为ENUM列表中的值在MySQL中都是以编号序列存储的，因此插入列表中的值'good'或者插入其对应序号'2'的结果时相同的；'best'不是列表中的值，因此不能插入数据。

<br>

**4. SET类型**

SET是一个字符串对象，可以有零个或多个值，SET列最多可以有64个成员，其值为表创建时规定的一个列值。指定包括多个SET成员的SET列值是，各成员之间用逗号(,)分隔开。

语法格式如下：

`SET('值1','值2',...,'值n')`

与ENUM类型相同，SET值在内部用整数表示，列表中每一个值都有一个索引编号。当创建表时，SET成员值的尾部空格将自动被删除。

但与ENUM类型不同的是，ENUM类型的字段只能从定义的列值中选择一个插入，而SET类型的列可以从定义的列值中选择多个字符的联合。

若插入SET字段中的列值有重复，则MySQL自动删除重复的值；插入SET字段的值顺序并不重要，MySQL会在存入数据库时，按照定义的顺序显示；若插入了不正确的值，默认情况下，MySQL将忽略这些值，并给出警告。

**示例1：** 创建表tmp11，定义SET类型的字段s，取值列表为('a','b','c','d')，插入数据('a'),('a,b,a'),('c,a,d'),('a,x,b,y')

```
mysql> CREATE TABLE tmp11 (s SET('a','b','c','d'));
Query OK, 0 rows affected (0.03 sec)

mysql> INSERT INTO tmp11 VALUES ('a'),('a,b,a'),('c,a,d');
Query OK, 3 rows affected (0.01 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql> INSERT INTO tmp11 VALUES ('a,x,b,y');
ERROR 1265 (01000): Data truncated for column 's' at row 1
```

由于插入了SET列不支持的值，因此MySQL抛出错误

查询结果

```
mysql> SELECT * FROM tmp11;
+-------+
| s     |
+-------+
| a     |
| a,b   |
| a,c,d |
+-------+
```

从结果可以看出:
* 对于SET来说如果插入的值为重复的，则只取一个，例如'a,b,a'结果为'a,b'；
* 若插入了不按顺序排列值，则自动按顺序插入，例如'c,a,d'结果为'a,c,d'；
* 若插入了不正确的值，该值将被阻止插入，例如'a,x,b,y'；

**5. 二进制字符串类型**

MySQL中的二进制数据类型有：BIT，BINARY，VARBINARY，TINYBLOB，BLOB，MEDIUMBLOB和LONGBLOB。

**MySQL中的二进制字符串类型**

|类型名称|说明|存储需求|
|:---|:---|:---|
|BIT(M)|位字段类型|大约(M+7)/8个字节|
|BINARY(M)|固定长度二进制字符串|M个字节|
|VARBINARY(M)|可变长度二进制字符串&#160;&#160;&#160;&#160;|M+1个字节|
|TINYBLOB(M)|非常小的BLOB|L+1个字节，L<2^8|
|BLOB(M)|小BLOB|L+2个字节，L<2^16|
|MEDIUMBLOB(M)&#160;&#160;&#160;&#160;|中等大小BLOB|L+3个字节，L<2^24|
|LONGBLOB(M)|非常大的BLOB|L+4个字节，L<2^32&#160;&#160;&#160;&#160;|

<br>

**1. BIT类型**

BIT类型是位字段类型。M表示每个值的位数，范围为1~64。若M被省略，默认是1。若BIT(M)列分配的值的长度小于M位，在值***左边***用0填充。

**示例：** 创建表tmp12，定义BIT(4)类型的字段b，向表中插入数据2，9，15

```
mysql> CREATE TABLE tmp12 (b BIT(4));
Query OK, 0 rows affected (0.13 sec)

mysql> INSERT INTO tmp12 VALUES(2),(9),(15);
Query OK, 3 rows affected (0.05 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql> SELECT BIN(b+0) FROM tmp12;
+----------+
| BIN(b+0) |
+----------+
| 10       |
| 1001     |
| 1111     |
+----------+
```

**b+0**表示将二进制的结果转换为对应的数字的值，**BIN()**函数将数字转换为二进制。

<br>

**2. BINARY和VARBINARY类型**

BINARY和VARBINARY类型类似于CHAR和VARCHAR，不同的是它们包含二进制字节字符串。

语法格式为：`列名称 BINARY(M) / VARBINARY(M)`

BINARY类型的长度是固定的，指定长度之后，不足最大长度的，将在它们的右边填充'\0'补齐以达到指定长度。

VARBINARY类型的长度是可变的，指定好长度之后，其长度可以在0到最大值之间，实际占用的空间为字符串的实际长度加1。

**示例：** 创建表tmp13，定义BINARY(3)类型的字段b和VARBINARY(3)类型的字段vb，并向表中插入数据'5'

```
mysql> CREATE TABLE tmp13 (b BINARY(3), vb VARBINARY(3));
Query OK, 0 rows affected (0.13 sec)

mysql> INSERT INTO tmp13 VALUES(5, 5);
Query OK, 1 row affected (0.05 sec)

mysql> SELECT length(b), length(vb) FROM tmp13;
+-----------+------------+
| length(b) | length(vb) |
+-----------+------------+
|         3 |          1 |
+-----------+------------+
```

进一步确认'5'在两个字段中不同的存储方式：

```
mysql> SELECT b,vb,b='5',b='5\0\0',vb='5\0\0' FROM tmp13;
+------+------+-------+-----------+------------+
| b    | vb   | b='5' | b='5\0\0' | vb='5\0\0' |
+------+------+-------+-----------+------------+
| 5    | 5    |     0 |         1 |          0 |
+------+------+-------+-----------+------------+
```

执行结果可以看出，b字段和vb字段的长度是截然不同的，因为b字段不足的空间田中了'\0'，而vb字段没有填充。

<br>

**3. BLOB类型**

BLOB是一个二进制大对象，用来存储可变数量的数据。BLOB类型分为4种：TINYBLOB，BLOB，MEDIUMBLOB和LONGBLOB，它们可以容纳值的最大长度不同。

BLOB列存储的是二进制字符串（字节字符串）；TEXT列存储的是非二进制字符串（字符字符串）。BLOB列没有任何字符集，并且排序和比较基于列值的数值；TEXT列有一个字符集，并且根据字符集对值进行排序和比较。

---

## 2.如何选择数据类型

为了优化存储，提高数据库性能，在任何情况下均应使用最精确的类型，即在所有可以表示该列值的类型中，该类型使用的存储最少。

**1. 整数和浮点数**

若不需要小数部分，则使用整数来保存数据；若需要表示小数部分，则使用浮点数类型。

对于浮点数据列，存入的数值会对该列定义的小数位进行四舍五入。

例：若列的值的范围是1~99999；
* 若使用整数，则MEDIUMINT UNSIGNED是最好的类型；
* 若需要存储小数，则使用FLOAT类型；

浮点类型包括FLOAT和DOUBLE类型。DOUBLE类型精度比FLOAT类型高，因此，如果要求存储精度较高时，应该选择DOUBLE类型。

**2. 浮点数和定点数**

浮点数FLOAT，DOUBLE相对于定点数DECIMAL的优势是：在长度一定的情况下，浮点数能表示更大的数据范围，但是由于浮点数容易产生误差，因此对精度要求比例较高时，建议使用DECIMAL来存储。

DECIMAL在MySQL中是以字符串存储的，用于定义货币等对精度要求较高的数据。

**3. 日期和时间类型**

若只需要记录年份，则使用YEAR类型即可；若只记录时间，只需要使用TIME类型；

若同时需要记录日期和时间，则可以使用TIMESTAMP和DATETIME类型。由于TIMESTAMP列的取值范围小于DATETIME的取值范围，因此存储范围较大的日期最好使用DATETIME。

TIMESTAMP也有一个DATETIME不具备的属性。默认情况下，当插入一条记录但并没有指定TIMESTAMP这个列值时，MySQL会把TIMESTAMP列设置为当前时间。

**4. CHAR和VARCHAR之间的特点和选择**

CHAR和VARCHAR的区别如下：
* CHAR是固定长度字符，VARCHAR是可变长度字符；
* CHAR会自动删除插入数据的尾部空格，VARCHAR不会删除尾部空格；

CHAR是固定长度的，所以它的处理速度比VARCHAR的速度快，但缺点是浪费存储空间。所以对存储不大，但在速度上有要求的可以使用CHAR类型，反之可以使用VARCHAR类型来实现。

存储引擎对选择CHAR和VARCHAR的影响：
* 对于MyISAM存储引擎：最好使用固定长度的数据列代替可变长度的数据列。这样可以使整个表静态化，从而使数据检索更快，用空间换时间。
* 对于InnoDB存储引擎：使用可变长度数据列，因为InnoDB数据表的存储格式部分固定长度和可变长度，因此使用CHA不一定比使用VARCHAR更好，但由于VARCHAR是按照实际的长度存储，比较节省空间，所以对磁盘I/O和数据存储总量比较好

**5. ENUM和SET**

ENUM只能取单值，它的数据列表是一个枚举集合。它的合法取值列最多允许有65535个成员。因此，在需要从多个值中选取一个时，可以使用ENUM。

SET可取多值。它的合法取值列表最多允许64个成员。空字符串也是一个合法的SET值。在需要取多个值的时候，适合使用SET类型。

**6. BLOB和TEXT**

BLOB是二进制字符串，TEXT是非二进制字符串，两者均可存放大容量的信息。BLOB主要存储图片，音频信息等，而TEXT只能存储纯文本文件。

---

## 3.常见运算介绍

### 3.1 运算符概述

MySQL内部运算符主要有四大类：
* 算术运算符；
* 比较运算符；
* 逻辑运算符；
* 位操作运算符；

<br>

### 3.2 算术运算符

算术运算符是SQL中最基本的运算符，MySQL运算符如下表所示：

**MySQL中的算术运算符**

|运算符&#160;&#160;&#160;&#160;|作用|
|:---|:---|
|+|加法运算|
|-|减法运算|
|*|乘法运算|
|/|除法运算，返回商|
|%|求余运算，返回余数&#160;&#160;&#160;&#160;|

**示例1：** 创建tmp14，定义数据类型为INT的字段num，插入值64，对num值进行算数运算

```
mysql> CREATE TABLE tmp14 (num INT);
Query OK, 0 rows affected (0.11 sec)

mysql> INSERT INTO tmp14 VALUES (64);
Query OK, 1 row affected (0.05 sec)

mysql> SELECT num, num+10, num-3+5, num+5-3, num+36.5 FROM tmp14;
+------+--------+---------+---------+----------+
| num  | num+10 | num-3+5 | num+5-3 | num+36.5 |
+------+--------+---------+---------+----------+
|   64 |     74 |      66 |      66 |    100.5 |
+------+--------+---------+---------+----------+
```

可以看到，可以对num字段的值进行假发和减法的运算，而且由'+'和'-'的优先级相同。

**示例2：** 对tmp14表中的num进行乘法，除法运算

```
mysql> SELECT num, num*2, num/2, num/3, num%3 FROM tmp14;
+------+-------+---------+---------+-------+
| num  | num*2 | num/2   | num/3   | num%3 |
+------+-------+---------+---------+-------+
|   64 |   128 | 32.0000 | 21.3333 |     1 |
+------+-------+---------+---------+-------+
```

由计算结果可以看到，对num进行除法运算时候，由于64无法被3整除，因此MySQL对num/3求商的结果保存到了小数点后四位，为21.3333。

在数学运算中，除数为0的除法是没有意义的，因此除法运算中的除数不能为0。若被0除，则结果返回NULL。

**示例3：** 用0除num

```
mysql> SELECT num, num/0, num%0 FROM tmp14;s
+------+-------+-------+
| num  | num/0 | num%0 |
+------+-------+-------+
|   64 |  NULL |  NULL |
+------+-------+-------+
```

<br>

### 3.3 比较运算符

一个比较运算符的结果总是1，0或者NULL，比较运算符经常在SELECT的查询条件字句中使用，用来查询满足指定条件的记录。

**MySQL中的比较运算符**

|运算符|作用|
|:---|:---|
|=|等于|
|<=>|安全的等于|
|<>(!=)|不等于|
|<=|小于等于|
|>=|大于等于|
|>|大于|
|IS NULL|判断一个值是否为NULL|
|IS NOT NULL&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;|判断一个值是否不为NULL|
|LEAST|在有两个或多个参数时，返回最小值|
|GREATEST|在有两个或多个参数是，返回最大值|
|BETWEEN AND|判断一个值是否落在两个值之间|
|ISNULL|与IS NULL作用相同|
|IN|判断一个值是IN列表中的任意一个值|
|NOT IN|判断一个值不是IN列表中的任意一个值&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;|
|LIKE|通配符匹配|
|REGEXP|正则表达式匹配|

<br>

**1. 等于运算符(=)**

等号(=)用来判断数字，字符串和表达式是否相等。如果相等，返回值为1，否则返回0。

**示例：** 使用'='进行相等判断

```
mysql> SELECT 1=0, '2'=2, 2=2, '0.02'=0,'b'='b', (1+3)=(2+2), NULL=NULL;
+-----+-------+-----+----------+---------+-------------+-----------+
| 1=0 | '2'=2 | 2=2 | '0.02'=0 | 'b'='b' | (1+3)=(2+2) | NULL=NULL |
+-----+-------+-----+----------+---------+-------------+-----------+
|   0 |     1 |   1 |        0 |       1 |           1 |      NULL |
+-----+-------+-----+----------+---------+-------------+-----------+
```

在进行判断时，2=2和'2'=2'都返回相同，都是1；MySQL自动进行了转换，把字符'2'转换成数字2；'b'='b'为相同的字符比较，因此返回值为1；表达式1+3和表达式2+2的结果都为4，因此相等，返回值1；由于'='不能用于空值NULL的判断，因此返回值为NULL。

数值比较时有如下规则：
1. 若有一个或两个参数为NULL，则比较运算的结果为NULL；
2. 若同一个比较运算中的两个参数都是字符串，则按照字符串进行比较；
3. 若两个参数均为整数，则按照整数进行比较；
4. 若一个字符串和数字进行相等判断，则MySQL可以自动将字符串转换为数字；

<br>

**2. 安全等于运算符(<=>)**

这个操作符和=操作符执行相同的比较操作，不过<=>可以用来判断NULL值。在连个操作均为NULL时，其返回值为1不为NULL；当一个操作数位NULL时，其返回值为0而不为NULL。

**示例：** 使用'<=>'进行相等的判断

```
mysql> SELECT 1<=>0, '2'<=>2, 2<=>2, '0.02'<=>0, 'b'<=>'b', (1+3)<=>(2+2), NULL<=>NULL;
+-------+---------+-------+------------+-----------+---------------+-------------+
| 1<=>0 | '2'<=>2 | 2<=>2 | '0.02'<=>0 | 'b'<=>'b' | (1+3)<=>(2+2) | NULL<=>NULL |
+-------+---------+-------+------------+-----------+---------------+-------------+
|     0 |       1 |     1 |          0 |         1 |             1 |           1 |
+-------+---------+-------+------------+-----------+---------------+-------------+
```

可以看到，'<=>'在执行比较操作时和'='的作用是相似的，唯一的区别是'<=>'可以对NULL进行判断，两者同时都为NULL时返回值为1；

<br>

**3. 不等于运算符(<>或者!=)**

'<>'或者'!='用于判断数字，字符串，表达式不相等的判断。若不相等，返回值为1；否则返回值为0。这两个运算符不能用于判断空值NULL。

**示例：** 使用'<>'和'!='进行不相等的判断

```
mysql> SELECT 'good'<>'good', 1<>2, 4!=4, 5.5!=5, (1+3)!=(2+2), NULL<>NULL;
+----------------+------+------+--------+--------------+------------+
| 'good'<>'good' | 1<>2 | 4!=4 | 5.5!=5 | (1+3)!=(2+2) | NULL<>NULL |
+----------------+------+------+--------+--------------+------------+
|              0 |    1 |    0 |      1 |            0 |       NULL |
+----------------+------+------+--------+--------------+------------+
```

<br>

**4. 小于或等于运算符(<=)**

'<='用来判断左边的操作是否小于或者等于右边的操作数。若小于或等于，返回值为1，否则返回值为0。'<='不能用于判断空值NULL。

**示例：** 使用'<='进行比较判断

```
mysql> SELECT 'good'<='god',1<=2,4<=4,5.5<=5,(1+3)<=(2+1),NULL<=NULL;
+---------------+------+------+--------+--------------+------------+
| 'good'<='god' | 1<=2 | 4<=4 | 5.5<=5 | (1+3)<=(2+1) | NULL<=NULL |
+---------------+------+------+--------+--------------+------------+
|             0 |    1 |    1 |      0 |            0 |       NULL |
+---------------+------+------+--------+--------------+------------+
```

<br>

**5. 小于运算符(<)**

'<'运算符用来判断左边的操作数是否小于右边的操作数，如果小于，返回值为1；否则返回值为0。'<'不能用于判断空值NULL。

**示例：** 使用'<'进行比较判断

```
mysql> SELECT 'good'<'god',1<2,4<4,5.5<5,(1+3)<(2+1),NULL<NULL;
+--------------+-----+-----+-------+-------------+-----------+
| 'good'<'god' | 1<2 | 4<4 | 5.5<5 | (1+3)<(2+1) | NULL<NULL |
+--------------+-----+-----+-------+-------------+-----------+
|            0 |   1 |   0 |     0 |           0 |      NULL |
+--------------+-----+-----+-------+-------------+-----------+
```

<br>

**6. 大于或等于运算符(>=)**

'>='运算符用来判断左边的操作数是否大于或者等于右边的操作数，如果大于或者等于，返回值为1；否则返回值为0。'>='不能用于判断空值NULL。

<br>

**7. 大于运算符(>)**

'>'运算符用来判断左边的操作数是否大于后边的操作数，如果大于，返回值为1；否则返回空值为0.'>'不能用于判断空值NULL。

<br>

**8. IS NULL(ISNULL), IS NOT NULL 运算符**

IS NULL和ISNULL检验一个值是否为NULL，若为NULL，返回值为1；否则返回值为0。

IS NOT NULL检验一个值是否为非NULL，若是非NULL，返回值为1；否则返回值为0。

**示例：** 使用IS NULL，ISNULL和IS NOT NULL判断NULL值和非NULL值

```
mysql> SELECT NULL IS NULL, ISNULL(NULL),ISNULL(10), 10 IS NOT NULL;
+--------------+--------------+------------+----------------+
| NULL IS NULL | ISNULL(NULL) | ISNULL(10) | 10 IS NOT NULL |
+--------------+--------------+------------+----------------+
|            1 |            1 |          0 |              1 |
+--------------+--------------+------------+----------------+
```

<br>

**9. BETWEEN AND 运算符**

语法格式为:`expr BETWEEN min AND max`

假如expr大于或等于min且小于或等于max，则BETWEEN的返回值为1，否则返回值为0。

**示例：** 使用BETWEEN AND进行值区间判断

```
mysql> SELECT 4 BETWEEN 2 AND 5, 4 BETWEEN 4 AND 6, 12 BETWEEN 9 AND 10;
+-------------------+-------------------+---------------------+
| 4 BETWEEN 2 AND 5 | 4 BETWEEN 4 AND 6 | 12 BETWEEN 9 AND 10 |
+-------------------+-------------------+---------------------+
|                 1 |                 1 |                   0 |
+-------------------+-------------------+---------------------+

mysql> SELECT 'x' BETWEEN 'f' AND 'g', 'b' BETWEEN 'a' AND 'c';
+-------------------------+-------------------------+
| 'x' BETWEEN 'f' AND 'g' | 'b' BETWEEN 'a' AND 'c' |
+-------------------------+-------------------------+
|                       0 |                       1 |
+-------------------------+-------------------------+
```

<br>

**10. LEAST 运算符**

语法格式为：`LEAST(值1,值2,...,值n)`

其中值n表示参数列表中有n个值。有两个或多个参数的情况下，返回最小值。假如任意一个自变量为NULL，则LEAST()的返回值为NULL。

**示例：** 使用LEAST运算符进行大小判断

```
mysql> SELECT LEAST(2,0), LEAST(20.0,3.0,100.5), LEAST('a','c','b'), LEAST(10, NULL);
+------------+-----------------------+--------------------+-----------------+
| LEAST(2,0) | LEAST(20.0,3.0,100.5) | LEAST('a','c','b') | LEAST(10, NULL) |
+------------+-----------------------+--------------------+-----------------+
|          0 |                   3.0 | a                  |            NULL |
+------------+-----------------------+--------------------+-----------------+
```

由结果可以看出，当参数中是整数或者浮点数时，LEAST将返回其中最小的值；当参数为字符串时，将返回字母表中顺序最靠前的字符；当比较列表中有NULL时，***不能判断大小***，返回NULL值。

<br>

**11. GREATEST(value1,value2,...)**

语法格式为：`GREATEST(值1,值2,...,值n)`

其中n表示参数列表中有n个值。当有两个或多个参数时，返回值为最大值，假如任意一个自变量为NULL，则GREATEST()的返回值为NULL。

**示例：** 使用GREASTEST运算符进行大小判断

```
mysql> SELECT GREATEST(2,0), GREATEST(20.0,3.0,100.5), GREATEST('a','b','c'), GREATEST(10,NULL);
+---------------+--------------------------+-----------------------+-------------------+
| GREATEST(2,0) | GREATEST(20.0,3.0,100.5) | GREATEST('a','b','c') | GREATEST(10,NULL) |
+---------------+--------------------------+-----------------------+-------------------+
|             2 |                    100.5 | c                     |              NULL |
+---------------+--------------------------+-----------------------+-------------------+
```

可以看到，当参数时整数或者浮点数时，GERATEST将返回其中最大的值；当参数为字符串时，返回字母表中顺序靠后的字符；当比较值列表中有NULL时，不能判断大小，返回NULL。

<br>

**12. IN，NOT IN 运算符**

IN运算符用来判断操作数是否为IN列表中的其中一个值，如果是，返回值为1；否则返回值为0。

NOT IN运算符用来判断表达式是否为IN列表中的其中一个值，如果不是，返回值为1；否则返回值为0。

**示例：** 使用IN，NOT IN运算符进行判断

```
mysql> SELECT 2 IN (1,3,5,'thks'), 'thks' IN (1,3,5,'thks');
+---------------------+--------------------------+
| 2 IN (1,3,5,'thks') | 'thks' IN (1,3,5,'thks') |
+---------------------+--------------------------+
|                   0 |                        1 |
+---------------------+--------------------------+

mysql> SELECT 2 NOT IN (1,3,5,'thks'), 'thks' NOT IN (1,3,5,'thks');
+-------------------------+------------------------------+
| 2 NOT IN (1,3,5,'thks') | 'thks' NOT IN (1,3,5,'thks') |
+-------------------------+------------------------------+
|                       1 |                            0 |
+-------------------------+------------------------------+
```

在左侧表达式为NULL的情况下，或是表达中找不到匹配项并且表中一个表达式为NULL的情况下，IN的返回值均为NULL。

```
mysql> SELECT NULL IN (1,3,5,'thks'), 10 IN (1,3,NULL,'thks');
+------------------------+-------------------------+
| NULL IN (1,3,5,'thks') | 10 IN (1,3,NULL,'thks') |
+------------------------+-------------------------+
|                   NULL |                    NULL |
+------------------------+-------------------------+
```

<br>

**13. LIKE**

LIKE运算符用来匹配字符串，语法格式为：`expr LIKE 匹配条件`

若expr满足匹配条件，则返回值为1(TRUE)；若不匹配，则返回值为0(FALSE)。若expr或匹配条件中任何一个NULL，则结果为NULL。

LIKE运算符在进行匹配时，可以使用下面两种通配符：
1. '%'，匹配任何数目的字符，甚至包括零字符；
2. '_'，只能匹配一个字符；

**示例：** 使用运算符LIKE进行字符串匹配运算

```
mysql> SELECT 'stud' LIKE 'stud', 'stud' LIKE 'stud_', 'stud' LIKE '%d', 'stud' LIKE 't___', 's' LIKE NULL;
+--------------------+----------------------+------------------+--------------------+---------------+
| 'stud' LIKE 'stud' | 'stud' LIKE 'stud_'  | 'stud' LIKE '%d' | 'stud' LIKE 't___' | 's' LIKE NULL |
+--------------------+----------------------+------------------+--------------------+---------------+
|                  1 |                    1 |                1 |                  0 |          NULL |
+--------------------+----------------------+------------------+--------------------+---------------+
```

'stud'表示世界匹配'stud'字符串，满足匹配条件，返回1；

'stu_'表示匹配以stu开头的长度为4的字符串，'stud'正好时4个字符串，满足匹配条件，返回1；

'%d'表示匹配以字母'd'结尾的字符串，'stud'满足匹配条件，返回1；

't___'表示匹配以't'开头的长度为4个字符的字符串，'stud'不满足匹配条件，返回0；

当字符's'与NULL匹配时，结果为NULL；

<br>

**14. REGEXP**

REGEXP运算符用来匹配字符串，语法格式为：`expr REGEXP`匹配条件，若expr满足匹配条件，返回1；若不满足，返回0；若expr或匹配条件任意一个为NULL，则结果为NULL。

REGEXP运算符在进行匹配时，通常有下面的几种通配符：
1. '^'匹配以该字符后面的字符开头的字符串；
2. '$'匹配以该字符后面的字符结尾的字符串；
3. '.'匹配任何一个单字符；
4. '[...]'匹配在方括号内的任何字符；
5. '*'匹配零个或多个在它前面的字符；

**示例：** 使用REGEXP进行字符串匹配运算

```
mysql> SELECT 'ssky' REGEXP '^s', 'ssky' REGEXP 'y$', 'ssky' REGEXP '.sky', 'ssky' REGEXP '[ab]';
+--------------------+--------------------+----------------------+----------------------+
| 'ssky' REGEXP '^s' | 'ssky' REGEXP 'y$' | 'ssky' REGEXP '.sky' | 'ssky' REGEXP '[ab]' |
+--------------------+--------------------+----------------------+----------------------+
|                  1 |                  1 |                    1 |                    0 |
+--------------------+--------------------+----------------------+----------------------+
```

<br>

### 3.4 逻辑运算符

在SQL中，所有逻辑运算符的求值所得结果均为TRUE，FALSE或NULL。

在MySQL中，它们体现为1(TRUE),0(FALSE)和NULL。

**MySQL中的逻辑运算符**

|运算符|作用|
|:---|:---|
|NOT 或者 !|逻辑非|
|AND 或者 &&&#160;&#160;&#160;&#160;|逻辑与|
|OR 或者 ‖|逻辑或|
|XOR|逻辑异或&#160;&#160;&#160;&#160;&#160;&#160;|

<br>

**1. NOT 或者 !**

逻辑非运算符NOT或者!表示当操作数为0时，所得值为1；当操作数为非零值时，所的值为0；当操作数为NULL时，所得的返回值为NULL。

**示例：** 分别使用非运算符"NOT"和"!"进行逻辑判断

```
mysql> SELECT NOT 10, NOT(1-1), NOT -5, NOT NULL, NOT 1+1;
+--------+----------+--------+----------+---------+
| NOT 10 | NOT(1-1) | NOT -5 | NOT NULL | NOT 1+1 |
+--------+----------+--------+----------+---------+
|      0 |        1 |      0 |     NULL |       0 |
+--------+----------+--------+----------+---------+

mysql> SELECT !10, !(1-1), !-5, !NULL, !1+1;
+-----+--------+-----+-------+------+
| !10 | !(1-1) | !-5 | !NULL | !1+1 |
+-----+--------+-----+-------+------+
|   0 |      1 |   0 |  NULL |    1 |
+-----+--------+-----+-------+------+
```

由结果可以看到，前4列"NOT"和"!"的返回值都相同，但最后一列出现了不同的值。这是因为"NOT"与"!"的**优先级不同**！

"NOT"的优先级低于"+"，因此"NOT 1+1"相当于"NOT (1+1)"。相反，"!"的优先级高于"+"运算，因此"! 1+1"的结果相当于"(!1)+1"，先计算"!1"，结果为0，然后0+1结果为1。

<br>

**2. AND 或者 &&**

逻辑运算符AND或者&&表示当所有操作数均为非零值，并且不为NULL时，计算所得结果为1；当一个或多个操作数为0时，所得结果为0，其余结果返回值为NULL。

**示例：** 分别使用运算符'AND'和'&&'进行逻辑判断

```
mysql> SELECT 1 AND -1, 1 AND 0, 1 AND NULL, 0 AND NULL;
+----------+---------+------------+------------+
| 1 AND -1 | 1 AND 0 | 1 AND NULL | 0 AND NULL |
+----------+---------+------------+------------+
|        1 |       0 |       NULL |          0 |
+----------+---------+------------+------------+

mysql> SELECT 1 && -1, 1 && 0, 1 && NULL, 0 && NULL;
+---------+--------+-----------+-----------+
| 1 && -1 | 1 && 0 | 1 && NULL | 0 && NULL |
+---------+--------+-----------+-----------+
|       1 |      0 |      NULL |         0 |
+---------+--------+-----------+-----------+
```

<br>

**3. OR 或者 ||**

逻辑运算符OR或者||表示当两个操作数均为非NULL值，且任意一个操作数为非零值时，结果为1，否则结果为0；当由一个操作数为NULL，且另外一个操作数为非零值时，则结果为1，否则结果为NULL；当两个操作数均为NULL时，则所得结果为NULL。

**示例：** 分别使用或运算符'OR'和'||'进行逻辑判断

```
mysql> SELECT 1 OR -1 OR 0, 1 OR 2, 1 OR NULL, 0 OR NULL, NULL OR NULL;
+--------------+--------+-----------+-----------+--------------+
| 1 OR -1 OR 0 | 1 OR 2 | 1 OR NULL | 0 OR NULL | NULL OR NULL |
+--------------+--------+-----------+-----------+--------------+
|            1 |      1 |         1 |      NULL |         NULL |
+--------------+--------+-----------+-----------+--------------+

mysql> SELECT 1 || -1 || 0, 1 || 2, 1 || NULL, 0 || NULL, NULL || NULL;
+--------------+--------+-----------+-----------+--------------+
| 1 || -1 || 0 | 1 || 2 | 1 || NULL | 0 || NULL | NULL || NULL |
+--------------+--------+-----------+-----------+--------------+
|            1 |      1 |         1 |      NULL |         NULL |
+--------------+--------+-----------+-----------+--------------+
```

<br>

**4. XOR**

逻辑异或运算符XOR。当任意一个操作数为NULL时，返回值为NULL；对于非NULL的操作数，若两个操作数都是非0值或者都是0值，则返回结果为0；若一个为0，另一个为非0值，返回结果为1。

**示例：** 使用异或运算符'XOR'进行逻辑判断

```
mysql> SELECT 1 XOR 1, 0 XOR 0, 1 XOR 0, 1 XOR NULL, 1 XOR 1 XOR 1;
+---------+---------+---------+------------+---------------+
| 1 XOR 1 | 0 XOR 0 | 1 XOR 0 | 1 XOR NULL | 1 XOR 1 XOR 1 |
+---------+---------+---------+------------+---------------+
|       0 |       0 |       1 |       NULL |             1 |
+---------+---------+---------+------------+---------------+
```

a XOR b的计算等同于(a AND (NOT b))或者((NOT a) AND b)。

<br>

### 3.5 位运算符

位运算符是用来对二进制字节中的位进行测试，移位或者测试处理，MySQL提供的的位运算符有：

|位运算符&#160;&#160;&#160;&#160;|作用|
|:---|:---|
|｜|位或|
|&|位与|
|^|位异或|
|<<|位左移|
|>>|位右移|
|~|位取反，反转所有比特&#160;&#160;&#160;&#160;|

<br>

**1. 位或运算符(|)**

位或运算的实质是将参与运算的几个数据，按对应的二进制数逐位进行逻辑或运算。对应的二进制位由一个或两个位1，则该位的运算结果位1，否则位0。

**示例：**

```
mysql> SELECT 10 | 15, 9 | 4 | 2;
+---------+-----------+
| 10 | 15 | 9 | 4 | 2 |
+---------+-----------+
|      15 |        15 |
+---------+-----------+
```

10的二进制数值为1010，15的二进制数值为1111，按或运算之后，结果为1111，即整数15；9的二进制数值为1001，4的二进制数值为0100，2的二进制数值为0010，按位或运算之后，结果为1111，也即整数15。其结果时一个64位无符号整数。

<br>

**2. 位与运算符(&)**

位与运算的实质是将参数运算的几个操作数，按对应的二进制数逐位进行逻辑运算。对应的二进制位都为1，则该位的运算结果为1，否则为0。

**示例：**

```
mysql> SELECT 10 & 15, 9 & 4 & 2;
+---------+-----------+
| 10 & 15 | 9 & 4 & 2 |
+---------+-----------+
|      10 |         0 |
+---------+-----------+
```

10的二进制数值为1010，15的二进制数值为1111，按位与运算之后，结果为1010，即整数10；9的二进制数值为1001，4的二进制数值为0100，2的二进制数为0010，按位与运算之后，结果为0000，即整数0。其结果是一个64位无符号整数。

<br>

**3. 位异或运算符(^)**

位异或运算的实质是将参与运算的两个数据，按对应的二进制数逐位进行逻辑异或运算。对应位的二进制数**不同**时，对应的结果才为1。若两个对应位数都是0或者都是1，则对应位的记过为0。

**示例：**

```
mysql> SELECT 10 ^ 15, 1 ^ 0, 1 ^ 1;
+---------+-------+-------+
| 10 ^ 15 | 1 ^ 0 | 1 ^ 1 |
+---------+-------+-------+
|       5 |     1 |     0 |
+---------+-------+-------+
```

10的二进制数值为1010，15的二进制数值为1111，按异或运算之后，结果为0101，即整数5；1的二进制数值为0001，0的二进制数值为0000，按异或运算之后，结果为0001；1和1本身二进制位完全相同，因此结果为0。

<br>

**4. 位左移运算符(<<)**

位左移运算符>>使指定的二进制值的所有位都左移指定的位数。左移指定位数之后，左边高位的数值将被移除，右边低位空出的位置用0补齐。

语法格式位：`expr<<n`

这里n指定值expr要位移的位数。

**示例：**

```
mysql> SELECT 1<<2, 4<<2;
+------+------+
| 1<<2 | 4<<2 |
+------+------+
|    4 |   16 |
+------+------+
```

1的二进制值位00000001，左移两位之后变成00000100，即十进制整数4；十进制4左移两位之后变成00010000，即变成十进制的16。

<br>

**5. 位右移运算符(>>)**

位右移运算符>>使指定的二进制值的所有位都右移指定的位数。右移指定位数之后，右边低位的数值将被移除，左边高位空出的位置用0补齐。

语法格式为：`expr>>n`

这里n指指定expr要位移的位数。

```
mysql> SELECT 1>>1, 16>>2;
+------+-------+
| 1>>1 | 16>>2 |
+------+-------+
|    0 |     4 |
+------+-------+
```

1的二进制值为00000001，右移1位之后变成00000000，即十进制整数0；16的二进制值为00010000，右移两位之后变成00000100，即十进制整数4。

<br>

**6. 位取反运算符(~)**

位取反运算的实质是将参与运算的数据，按对应的二进制数逐位反转，即1取反后变成0，0取反后变为1。

**示例：**

```
mysql> SELECT 5 & ~1;
+--------+
| 5 & ~1 |
+--------+
|      4 |
+--------+
```

逻辑运算5&~1，由于位取反运算'~'的级别高于运算符'&'，因此先对1取反操作，取反之后，除了最低为位0其他都为1，然后再与十进制数值5进行与运算，结果为0100，即整数4。

可以使用BIN()函数查看1取反之后的结果：

```
mysql> SELECT BIN(~1);
+------------------------------------------------------------------+
| BIN(~1)                                                          |
+------------------------------------------------------------------+
| 1111111111111111111111111111111111111111111111111111111111111110 |
+------------------------------------------------------------------+
```

<br>

### 3.6 运算符的优先级

**运算符按优先级由低到高排列**

|优先级|运算符|
|:---|:---|
|最低|=（赋值运算），:=|
|<E>|‖，OR|
|<E>|&&，AND|
|<E>|NOT|
|<E>|BETWEEN，CASE，WHEN，THEN，ELSE|
|<E>|=（比较运算），<=>，>=，>，<=，<，<>，!=，IS，LIKE，REGEXP，IN&#160;&#160;&#160;&#160;&#160;&#160;|
|<E>|｜|
|<E>|&|
|<E>|<<，>>|
|<E>|-，+|
|<E>|*，/（DIV），%（MOD）|
|<E>|^|
|<E>|-（负号），~（位反转）|
|最高&#160;&#160;&#160;&#160;&#160;&#160;|!|

在无法确定优先级的情况下，可以使用圆括号()来改变优先级。

---

## 4.综合案例

创建表tmp15，其中包含VARCHAR类型的字段note和INT类型的字段price，使用运算符对表tmp15中不同的字段进行运算；使用逻辑操作符对数据进行逻辑操作；使用位操作符对数据进行位操作。

**创建表tmp15**

```
mysql> CREATE TABLE tmp15 (note VARCHAR(100), price INT);
Query OK, 0 rows affected (0.09 sec)

mysql> INSERT INTO tmp15 VALUES ("Thisisgood", 50);
Query OK, 1 row affected (0.06 sec)
```

对表tmp15中的整数型数值字段price进行算术运算：

```
mysql> SELECT price, price+10, price-10, price*2, price/2, price%3 FROM tmp15;
+-------+----------+----------+---------+---------+---------+
| price | price+10 | price-10 | price*2 | price/2 | price%3 |
+-------+----------+----------+---------+---------+---------+
|    50 |       60 |       40 |     100 | 25.0000 |       2 |
+-------+----------+----------+---------+---------+---------+
```

对表tmp15中的整型数值字段price进行比较运算：

```
mysql> SELECT price, price>10, price<10, price!=10, price=10, price<=>10, price<>10 FROM tmp15;
+-------+----------+----------+-----------+----------+------------+-----------+
| price | price>10 | price<10 | price!=10 | price=10 | price<=>10 | price<>10 |
+-------+----------+----------+-----------+----------+------------+-----------+
|    50 |        1 |        0 |         1 |        0 |          0 |         1 |
+-------+----------+----------+-----------+----------+------------+-----------+
```

判断price值是否落在30~80区间；返回与70，30相比最大的值，判断price是否为IN列表(10,20,50,35)中的某个值：

```
mysql> SELECT price, price BETWEEN 30 AND 80, GREATEST(price,70,30), price IN (10,20,50,35) FROM tmp15;
+-------+-------------------------+-----------------------+------------------------+
| price | price BETWEEN 30 AND 80 | GREATEST(price,70,30) | price IN (10,20,50,35) |
+-------+-------------------------+-----------------------+------------------------+
|    50 |                       1 |                    70 |                      1 |
+-------+-------------------------+-----------------------+------------------------+
```

对tmp15中的字符串数值字段note进行比较运算，判断表tmp15中note字段是否为空；使用LIKE判断是否以字母't'开头；使用REGEXP判断是否以字母'y'结尾；判断是否包含字母'g'或者'm'：

```
mysql> SELECT note, note IS NULL, note LIKE 't%', note REGEXP '$y', note REGEXP '[gm]' FROM tmp15;
+------------+--------------+----------------+------------------+--------------------+
| note       | note IS NULL | note LIKE 't%' | note REGEXP '$y' | note REGEXP '[gm]' |
+------------+--------------+----------------+------------------+--------------------+
| Thisisgood |            0 |              1 |                0 |                  1 |
+------------+--------------+----------------+------------------+--------------------+
```

将price字段值与NULL，0进行逻辑运算：

```
mysql> SELECT price, price && 1, price && NULL, price||0, price AND 0, 0 AND NULL, price OR NULL FROM tmp15;
+-------+------------+---------------+----------+-------------+------------+---------------+
| price | price && 1 | price && NULL | price||0 | price AND 0 | 0 AND NULL | price OR NULL |
+-------+------------+---------------+----------+-------------+------------+---------------+
|    50 |          1 |          NULL |        1 |           0 |          0 |             1 |
+-------+------------+---------------+----------+-------------+------------+---------------+

mysql> SELECT price, !price, NOT NULL, price XOR 3, 0 XOR NULL, price XOR 0 FROM tmp15;
+-------+--------+----------+-------------+------------+-------------+
| price | !price | NOT NULL | price XOR 3 | 0 XOR NULL | price XOR 0 |
+-------+--------+----------+-------------+------------+-------------+
|    50 |      0 |     NULL |           0 |       NULL |           1 |
+-------+--------+----------+-------------+------------+-------------+
```

将price字段值与2，4进行按位与，按位或操作，并对price进行按位操作：

```
mysql> SELECT price, price&2, price|4, ~price FROM tmp15;
+-------+---------+---------+----------------------+
| price | price&2 | price|4 | ~price               |
+-------+---------+---------+----------------------+
|    50 |       2 |      54 | 18446744073709551565 |
+-------+---------+---------+----------------------+
```

将price字段值分别左移和右移两位：

```
mysql> SELECT price, price<<2, price>>2 FROM tmp15;
+-------+----------+----------+
| price | price<<2 | price>>2 |
+-------+----------+----------+
|    50 |      200 |       12 |
+-------+----------+----------+
```

---






# 数据类型和运算符

## 1.MySQL数据类型介绍

MySQL支持多种数据类型，主要有数值类型，日期/时间类型和字符串类型：
1. 数值数据类型：包括整数类型TINYINT,SMALLINT,MEDIUMINT,INT,BIGINT,浮点小数数据类型FLOAT和DOUBLE，定点小数类型DECIMAL；
2. 日期/时间类型：包括YEAR,TIME,DATE,DATETIME和TIMESTAMP；
3. 字符串类型：包括CHAR,VARCHAR,BINARY,VARBINARY,BLOB,TEXT,ENUM和SET等。字符串类型分为文本字符串和二进制字符串。

### 1.1 整数类型

数值型数据类型主要用来存储数字，MySQL提供了多种数据类型，不同的数据类型提供不同的取值范围，可以存储的值范围越大，其所需的存储空间就会越大。

MySQL主要提供的整数类型有：TINYINT，SMALLINT,MEDIUMINT,INT(INTEGER),BIGINT。整数类型的属性字段可以添加AUTO_INCREMENT自增约束条件。如表所示：

**MySQL中的整数型数据类型**

|类型名称|说明|存储需求|
|:---|:---|:---|
|TINYINT|很小的整数|1个字节|
|SMALLINT|小的整数|2个字节|
|MEDIUMINT|中等大小的整数|3个字节|
|INT(INTEGER)&#160;&#160;&#160;&#160;&#160;&#160;|普通大小的整数&#160;&#160;&#160;&#160;&#160;&#160;|4个字节&#160;&#160;&#160;&#160;&#160;&#160;|
|BIGINT|大整数|8个字节|

**不同整数类型的取值范围**

|数据类型|有符号|无符号|
|:---|:---|:---|
|TINYINT|-128~127|0~255|
|SMALLINT|-32768~32767|0~65535|
|MEDIUMINT|-8388608~8388607|0~16777215|
|INT(INTEGER)&#160;&#160;&#160;&#160;&#160;&#160;|-2147483648~2147483647|0~4294967295|
|BIGINT|-9223372036854775808~9223372036854775807&#160;&#160;&#160;&#160;|0~18446744073709551615&#160;&#160;&#160;&#160;|

在“数据表的基本操作”章节中，有如下创建表的语句：

```
mysql> create table tb_emp1
    -> (
    -> id INT(11),
    -> name VARCHAR(25),
    -> deptId INT(11),
    -> salary FLOAT
    -> );
```

id字段的数据类型为INT(11)，INT括号中的数字表示的是该数据类型指定的显示宽度，指能够显示的数值中数字的个数。

例如：声明一个INT类型的字段：

```
year INT(4)
```

该声明指，在year字段中的数据一般只显示4位数字的宽度。

**注意：** 显示宽度和数据类型的取值范围是无关的。显示宽度只是指明MySQL最大可能显示的数字个数，数值的位数小于指定的宽度时会由空格填充；如果插入了大于显示宽度的值，只该值不超过该类型整数的取值范围，数值依然可以插入，而且能够显示出来。

**示例：** 创建表tmp1，其字段x，y，z，m，n数据类型依次为TINYINT，SMALLINT，MEDIUMINT，INT，BIGINT：

```
mysql> CREATE TABLE tmp1 (x TINYINT, y SMALLINT, z MEDIUMINT, m INT, n BIGINT);
mysql> DESC tmp1;
+-------+--------------+------+-----+---------+-------+
| Field | Type         | Null | Key | Default | Extra |
+-------+--------------+------+-----+---------+-------+
| x     | tinyint(4)   | YES  |     | NULL    |       |
| y     | smallint(6)  | YES  |     | NULL    |       |
| z     | mediumint(9) | YES  |     | NULL    |       |
| m     | int(11)      | YES  |     | NULL    |       |
| n     | bigint(20)   | YES  |     | NULL    |       |
+-------+--------------+------+-----+---------+-------+
5 rows in set (0.00 sec)
```

若没有无标明类型的显示宽度，系统将添加不同的默认宽度。这些默认宽度可以保证显示每一种数据类型可以取到范围内的所有值。

<br>

### 1.2 浮点数类型和定点数类型

MySQL中使用浮点数和定点数来表示小数。

浮点类型有两种：单精度浮点类型(FLOAT)和双精度浮点类型(DOUBLE)。

定点类型只有一种：DECIMAL。

浮点类型和定点类型都可以用(M,N)来表示，其中M称为精度，表示总共的位数；N称为标度，是表示小数的位数。

**MySQL中的小数类型**

|类型名称|说明|存储需求|
|:---|:---|:---|
|FLOAT|单精度浮点数|4个字节|
|DOUBLE|双精度浮点数|8个字节|
|DECIMAL(M,D),DEC&#160;&#160;&#160;&#160;|压缩的“严格”定点数&#160;&#160;&#160;&#160;|M+2个字节&#160;&#160;&#160;&#160;|

DECIMAL类型不同于FLOAT和DOUBLE，DECIMAL实际是以串存放的，DECIMAL可能的最大取值范围与DOUBLE一样，但其有效的取值范围由M和D的值决定。

**示例：** 创建表tmp2，其中字段x，y，z数据类型依次为FLOAT(5,1)，DOUBLE(5,1)和DECIMAL(5,1)，并向表中插入数据5.12，5.15和5.123：

```
mysql> CREATE TABLE tmp2 (x FLOAT(5,1), y DOUBLE(5,1), z DECIMAL(5,1));
Query OK, 0 rows affected, 2 warnings (0.14 sec)
mysql> INSERT INTO tmp2 VALUES(5.12, 5.15, 5.123);
Query OK, 1 row affected, 1 warning (0.06 sec)
```

插入数据时，MySQL会抛出一个警告信息，使用SHOW WARNINGS可以查看警告信息：

```
mysql> SHOW WARNINGS;
+-------+------+----------------------------------------+
| Level | Code | Message                                |
+-------+------+----------------------------------------+
| Note  | 1265 | Data truncated for column 'z' at row 1 |
+-------+------+----------------------------------------+
1 row in set (0.00 sec)
```

可以看到FLOAT和DOUBLE在进行四舍五入时并没有发出警告，但给出z字段数值被阶段的警告。查看结果：

```
mysql> SELECT * FROM tmp2;
+------+------+------+
| x    | y    | z    |
+------+------+------+
|  5.1 |  5.2 |  5.1 |
+------+------+------+
1 row in set (0.00 sec)
```
FLOAT和DOUBLE在不指定精度时，默认会按照实际的精度，DECIMAL若不指定精度，默认是(10,0)。

**浮点数相对与定点数的优点在于在长度一定的情况下，浮点数能够表示更大的数据范围；但缺点是会引发精度问题**

#### 提示

在MySQL中，定点数以字符串形式存储，在对精度要求比较高的时候（如货币，科学数据等）使用DECIMAL的类型比较好，另外两个浮点数进行减法和比较运算时也容易出问题，所以在使用浮点型时需要注意，并尽量避免做浮点比较。

<br>

### 1.3 日期与时间类型

MySQL中有多种表示日期的数据类型，主要有：DATETIME，DATE，TIMESTAMP，TIME和YEAR。每一个类型都会有合法的取值范围，当指定确实不合法的值时系统将“零”值插入到数据库中。

**日期与实践数据类型**

|类型名称|日期格式|日期范围|存储需求|
|:---|:---|:---|:---|
|YEAR|YYYY|1901~2155|1字节|
|TIME|HH：MM：SS|-835：59：59~838：59：59|3字节|
|DATE|YYYY-MM-DD|1000-01-01~9999-12-31|3字节|
|DATETIME|YYYY-MM-DD HH：MM：SS|1000-01-01 00：00：00~9999-12-31 23：59：59|8字节|
|TIMESTAMP&#160;&#160;|YYYY-MM-DD HH：MM：SS&#160;&#160;|1970-01-01 00：00：01 UTC~2038-01-19 03：14：07 UTC&#160;&#160;|4字节&#160;&#160;&#160;&#160;|

<br>

**1. YEAR**

YEAR类型是一个单字节类型用来表示年，在存储时只需要1个字节。可以使用各种形式指定YEAR值，如下：

1. 以4位字符串或者4位数字格式表示的YEAR，范围为‘1901’~‘2155’。输入格式为‘YYYY’或YYYY。
2. 以2位字符串格式表示YEAR，范围为‘00’到‘99’。‘00’~‘69’和‘70’~‘99’范围的值分别被转换为2000~2069和1970~1999范围的YEAR值。
3. 以2位数字表示YEAR，范围位1~99.1~69和70~99范围的值分别被转换位2001~2069和1970~1999范围的YEAR值。注意：这里的0值将被转换位0000，而不是2000。

**示例1：** 创建数据表tmp3，定义数据类型位YEAR的字段y，向表中插入值2010，‘2010’，‘2166’

```
mysql> CREATE TABLE tmp3(y YEAR);
Query OK, 0 rows affected (0.13 sec)

mysql> INSERT INTO tmp3 VALUES(2010), ('2010');
Query OK, 2 rows affected (0.05 sec)
Records: 2  Duplicates: 0  Warnings: 0

mysql> INSERT INTO tmp3 VALUES('2166');
ERROR 1264 (22003): Out of range value for column 'y' at row 1
mysql> SHOW WARNINGS;
+-------+------+--------------------------------------------+
| Level | Code | Message                                    |
+-------+------+--------------------------------------------+
| Error | 1264 | Out of range value for column 'y' at row 1 |
+-------+------+--------------------------------------------+
1 row in set (0.00 sec)
```

可以看到，插入第3个值2166超过了YEAR类型的取值范围，因此不能正常的执行插入操作。

```
mysql> SELECT * FROM tmp3;
+------+
| y    |
+------+
| 2010 |
| 2010 |
+------+
```

**示例2：** 向tmp3表中y字段插入2个字符串表示的YEAR值，分别位‘0’，‘00’，‘77’和‘10’

```
mysql> DELETE FROM tmp3;
Query OK, 2 rows affected (0.05 sec)

mysql> INSERT INTO tmp3 VALUES('0'),('00'),('77'),('10');
Query OK, 4 rows affected (0.05 sec)
Records: 4  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM tmp3;
+------+
| y    |
+------+
| 2000 |
| 2000 |
| 1977 |
| 2010 |
+------+
```

**示例3：** 向tmp3表中y字段插入2位数字表示的YEAR值，分别位0，78和11

```
mysql> DELETE FROM tmp3;
Query OK, 4 rows affected (0.05 sec)

mysql> INSERT INTO tmp3 VALUES (0),(78),(11);
Query OK, 3 rows affected (0.05 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM tmp3;
+------+
| y    |
+------+
| 0000 |
| 1978 |
| 2011 |
+------+
```

<br>

**2. TIME**

TIME类型用于只需要时间信息的值，在存储时需要3个字节。格式位'HH：MM：SS'。HH表示小时；MM表示分钟；SS表示秒。小时部分之所以那么大，是因为TIME类型不仅可以用于表示一天的时间（必须小于24小时），还可能是某个事件过去的时间或两个时间之间的时间间隔。

可以使用各种格式指定TIME值：
1. ‘D HH：MM：SS’格式的字符串。还可以使用下面任何一种“非严格”的语法：‘HH：MM：SS’，‘HH：MM’，‘D HH：MM’，‘D HH'或’SS'。这里的D表示日，可以取0~34之间的值。在插入数据库时，D被转换为小时保存，格式为“D*24+HH”。
2. ‘HHMMSS’格式的，没有间隔符的字符串或者HHMMSS格式的值，假定是有意义的时间。

#### 提示

为TIME列分配简写值时应注意：如果没有冒号，MySQL解释值时，假定最后边的两位表示秒！

**示例1：** 创建数据表tmp4，定义数据类型为TIME的字段，向表中插入‘10：05：05’，‘23：23’，‘2 10：10’，‘3 02’，‘10’

```
mysql> CREATE TABLE tmp4(t TIME);
Query OK, 0 rows affected (0.13 sec)

mysql> INSERT INTO tmp4 VALUES('10:05:05'),('23:23'),('2 10:10'),('3 02'),('10');
Query OK, 5 rows affected (0.01 sec)
Records: 5  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM tmp4;
+----------+
| t        |
+----------+
| 10:05:05 |
| 23:23:00 |
| 58:10:00 |
| 74:00:00 |
| 00:00:10 |
+----------+
```

**示例2：** 向表tmp4中插入值‘101112’，111213，‘0’，107010

```
mysql> DELETE FROM tmp4;
Query OK, 5 rows affected (0.00 sec)

mysql> INSERT INTO tmp4 VALUES('101112'),(111213),('0');
Query OK, 3 rows affected (0.01 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql> INSERT INTO tmp4 VALUES(107010);
ERROR 1292 (22007): Incorrect time value: '107010' for column 't' at row 1
mysql> SHOW WARNINGS;
+-------+------+--------------------------------------------------------+
| Level | Code | Message                                                |
+-------+------+--------------------------------------------------------+
| Error | 1292 | Incorrect time value: '107010' for column 't' at row 1 |
+-------+------+--------------------------------------------------------+
1 row in set (0.00 sec)

mysql> SELECT * FROM tmp4;
+----------+
| t        |
+----------+
| 10:11:12 |
| 11:12:13 |
| 00:00:00 |
+----------+
```

**示例3：** 向tmp4表中插入系统当前时间

```
mysql> DELETE FROM tmp4;
Query OK, 3 rows affected (0.05 sec)

mysql> INSERT INTO tmp4 VALUES (CURRENT_TIME),(NOW());
Query OK, 2 rows affected (0.01 sec)
Records: 2  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM tmp4;
+----------+
| t        |
+----------+
| 14:11:37 |
| 14:11:37 |
+----------+
```

<br>

**3. DATE类型**

DATE类型用在仅需要日期值时，没有时间部分，在存储时需要3个字节。日期格式为‘YYYY-MM-DD’，其中YYYY表示年；MM表示月；DD表示日。

在给DATE类型的字段赋值时，可以使用字符串类型或者数字类型的数据插入，只要DATE的日期格式即可：
1. 以‘YYYY-MM-DD’或者‘YYYYMMDD’字符串格式表示的日期，取值范围为‘1000-01-01’~‘9999-12-31’。
2. 以‘YY-MM-DD’或者‘YYMMDD’字符串格式表示的日期，在这里YY表示两位的年值。
3. 以YY-MM-DD或者YYMMDD数字格式表示的日期。
4. 使用CURRENT_DATE或者NOW()，插入当前系统日期。

**示例1：** 创建数据表tmp5，定义数据类型为DATE的字段d，向表中插入“YYYY-MM-DD”和“YYYYMMDD”字符串格式日期

```
mysql> CREATE TABLE tmp5 (d DATE);
Query OK, 0 rows affected (0.04 sec)

mysql> INSERT INTO tmp5 VALUES ('1998-08-08'),('19980808'),('20101010');
Query OK, 3 rows affected (0.01 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM tmp5;
+------------+
| d          |
+------------+
| 1998-08-08 |
| 1998-08-08 |
| 2010-10-10 |
+------------+
```

**示例2：** 向tmp5表中插入“YY-MM-DD"和“YYMMDD”字符串格式的日期

```
mysql> DELETE FROM tmp5;
Query OK, 3 rows affected (0.01 sec)

mysql> INSERT INTO tmp5 VALUES ('99-09-09'),('990909'),('000101'),('111111');
Query OK, 4 rows affected (0.00 sec)
Records: 4  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM tmp5;
+------------+
| d          |
+------------+
| 1999-09-09 |
| 1999-09-09 |
| 2000-01-01 |
| 2011-11-11 |
+------------+
```

**示例3：** 向tmp5表中插入YY-MM-DD和YYMMDD数字格式日期

```
mysql> DELETE FROM tmp5;
Query OK, 3 rows affected (0.01 sec)

mysql> INSERT INTO tmp5 VALUES (990909),( 000101),( 111111);
Query OK, 3 rows affected (0.01 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM tmp5;
+------------+
| d          |
+------------+
| 1999-09-09 |
| 2000-01-01 |
| 2011-11-11 |
+------------+
```

**示例4：** 向tmp5表中插入系统当前日期

```
mysql> DELETE FROM tmp5;
Query OK, 3 rows affected (0.01 sec)

mysql> INSERT INTO tmp5 VALUES (CURRENT_DATE()),(NOW());
Query OK, 2 rows affected, 1 warning (0.01 sec)
Records: 2  Duplicates: 0  Warnings: 1

mysql> SELECT * FROM tmp5;
+------------+
| d          |
+------------+
| 2019-11-18 |
| 2019-11-18 |
+------------+
```

CURRENT_DATE只返回当前日期，不包括时间部分；NOW()函数返回日期和时间值，在保存到数据库时，只保留了其日期部分。

**4. DATETIME**

DATETIME类型用在需要同时包含日期和时间信息的值，在存储时需要8个字节。日期格式为‘YYYY-MM-DD HH：MM：SS’。

其中：

* YYYY表示年；
* MM表示月；
* DD表示日；
* HH表示小时；
* MM表示分钟；
* SS表示秒；

在给DATETIME类型的字段赋值时，可以使用字符串类型或数字类型的数据插入，只要符合DATETIME的日期格式即可，如：
1. 以‘YYYY-MM-DD HH：MM：SS’或者‘YYYYMMDDHHMMSS’字符串格式表示的值，取值范围为‘1000-01-01 00：00：00’~‘9999-12-31 23：59：59’。
2. 以‘YY-MM-DD HH：MM：SS’或者‘YYMMDDHHMMSS’字符串格式表示的日期，这里YY表示两位的年值。
3. 以YYYYMMDDHHMMSS或者YYMMDDHHMMSS数字格式表示的日期和时间。

**示例1：** 创建数据表tmp6，定义数据类型为DATETIME的字段dt，向表中插入“YYYY-MM-DD HH：MM：SS”和“YYYYMMDDHHMMSS”字符串格式的日期和时间值

```
mysql> CREATE TABLE tmp6 (dt DATETIME);
Query OK, 0 rows affected (0.14 sec)

mysql> INSERT INTO tmp6 VALUES ('1998-08-08 08:08:08'),('19980808080808'),('20101010101010');
Query OK, 3 rows affected (0.06 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM tmp6;
+---------------------+
| dt                  |
+---------------------+
| 1998-08-08 08:08:08 |
| 1998-08-08 08:08:08 |
| 2010-10-10 10:10:10 |
+---------------------+
```

**示例2：** 向tmp6表中插入“YY-MM-DD HH：MM：SS”和“YYMMDDHHMMSS”字符串格式日期值和时间值

```
mysql> DELETE FROM tmp6;
Query OK, 3 rows affected (0.05 sec)

mysql> INSERT INTO tmp6 VALUES ('99-09-09 09:09:09'),('990909090909'),('101010101010');
Query OK, 3 rows affected (0.05 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM tmp6;
+---------------------+
| dt                  |
+---------------------+
| 1999-09-09 09:09:09 |
| 1999-09-09 09:09:09 |
| 2010-10-10 10:10:10 |
+---------------------+
```

**示例3：** 向tmp6表中插入YYYYMMDDHHMMSS和YYMMDDHHMMSS数字格式日期和时间值

```
mysql> DELETE FROM tmp6;
Query OK, 3 rows affected (0.05 sec)

mysql> INSERT INTO tmp6 VALUES (19990909090909),(101010101010);
Query OK, 2 rows affected (0.05 sec)
Records: 2  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM tmp6;
+---------------------+
| dt                  |
+---------------------+
| 1999-09-09 09:09:09 |
| 2010-10-10 10:10:10 |
+---------------------+
```

**示例4：** 向tmp6表中插入系统当前日期和时间值

```
mysql> DELETE FROM tmp6;
Query OK, 2 rows affected (0.05 sec)

mysql> INSERT INTO tmp6 VALUES (NOW());
Query OK, 1 row affected (0.05 sec)

mysql> SELECT * FROM tmp6;
+---------------------+
| dt                  |
+---------------------+
| 2019-11-18 21:58:51 |
+---------------------+
```

NOW()函数返回当前系统的日期和时间，格式为“YYYY-MM-DD HH：MM：SS”

**5. TIMESTAMP**

TIMESTAMP是显示格式与DATETIME相同，显示宽度固定在19个字符，日期格式为YYYY-MM-DD HH：MM：SS，在存储时需要4个字节。

但是TIMESTAMP列的取值范围小于DATETIME的取值范围，为‘1970-01-01 00：00：01’ UTC ~ ‘2038-01-19 03：14：07’ UTC，其中UTC为时间标准时间

**示例1：** 创建数据表tmp7，定义数据类型为TIMESTAMP的字段ts，向表中插入值‘19950101010101’，‘950505050505’，‘1996-02-02 02：02：02’，‘97@03@03@03@03@03’，121212121212，NOW()

```
mysql> CREATE TABLE tmp7 (ts TIMESTAMP);
Query OK, 0 rows affected (0.14 sec)

mysql> INSERT INTO tmp7 VALUES ('19950101010101'),('950505050505'),('1996-02-02 02:02:02'),('97@03@03@03@03@03'),(121212121212),(NOW());
Query OK, 6 rows affected (0.07 sec)
Records: 6  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM tmp7;
+---------------------+
| ts                  |
+---------------------+
| 1995-01-01 01:01:01 |
| 1995-05-05 05:05:05 |
| 1996-02-02 02:02:02 |
| 1997-03-03 03:03:03 |
| 2012-12-12 12:12:12 |
| 2019-11-18 23:05:52 |
+---------------------+
```

#### 提示

TIMESTAMP与DATETIME除了在存储字节和支持的范围不同外，还有一个最大的区别就是：

* DATETIME在存储日期数据时，按实际输入的格式存储，与时间无关；
* TIMESTAMP值的存储是以UTC(世界标准时间)格式保存的，存储时对当前时区进行转换，检索时再转换回当前时区。

**示例2：** 向tmp7表中插入当前日期，查看插入值，更改时区为东10区

```
mysql> DELETE FROM tmp7;
Query OK, 6 rows affected (0.05 sec)

mysql> INSERT INTO tmp7 VALUES (NOW());
Query OK, 1 row affected (0.05 sec)

mysql> SELECT * FROM tmp7;
+---------------------+
| ts                  |
+---------------------+
| 2019-11-18 23:08:19 |
+---------------------+

mysql> SET TIME_ZONE='+10:00';
Query OK, 0 rows affected (0.06 sec)

mysql> SELECT * FROM tmp7;
+---------------------+
| ts                  |
+---------------------+
| 2019-11-19 01:08:19 |
+---------------------+
```

可以看到，因为东十区时间比东八区快2个小时，因此查询的结果经过时区转换之后，显示的值增加了2个小时。

---






